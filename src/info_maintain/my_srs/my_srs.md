SRS推流直播
===
不理解相关概念的先阅读srs介绍部分。

## Demo测试流程
服务端已搭建好，测试需要向服务端推流和在客户端拉流观看。  

1. 下载开源推流软件OBS，你可能见过一些主播在使用此软件。
[官网](https://obsproject.com/)
根据自己的操作系统选择对应版本下载⏬。  
如果打不开，百度搜索obs在其它软件站下载，大约100Mb。  
网上有些教程使用ffmpeg，obs也是基于ffmpeg的，但命令行工具不方便，还是建议obs。
2. 设置和使用obs推流
3. 访问或下载客户端
<a href="./static/my_srs/client.html" download="live_client.html">点击下载</a>
客户端可以分发给多个多个下位机。
如果你自建srs服务，可以查看客户端源代码修改指向的服务器地址。
[](https://srs.1owo.com/)

4. 打开客户端

---

## 介绍
> SRS/3.0，OuXuli，是一个流媒体集群，支持RTMP/HLS/WebRTC/SRT/GB28181，高效、稳定、易用，简单而快乐。  

[github srs](https://github.com/ossrs/srs)
作者是国人，从项目文档可以看到作者深耕直播行业数年，长长的update list，是个非常认真的人，让人佩服。
## 场景: 
- 直播和视频资源站。视频自互联网出现以来经久不衰，多感官的信息输入是最优质的媒介。从早年长视频资源站优酷土豆爱奇艺，到2016年斗鱼游戏直播，
到2017年-2019年短视频抖音快手淘宝直播，到2020年初疫情期间钉钉直播授课、抖音直播。随着技术成熟，网络带宽、手机硬件环境跟上，产品创意层出不穷，
从明星到素人，人人都在玩直播。
- macOS屏幕分享给多台windows授课。  
    原以为是个简单的需求，结果发现没有一款软件好用，**低延迟是最大难题**。下面是踩过的坑:  
    - InletexEMC是windows平台的局域网同屏软件。这款软件动态画面例如滚动屏幕清晰度自动降低至马赛克画质，静态画面画质却不错能看清代码，
      延迟大约在0.3s可以忽略不计，完美契合需求。使用这个软件时感觉是个界面年代久远的简单软件，但到后面发现没有超过这个软件的。
      查了下，它的优秀因为基于windows自带的mstsc远程控制协议，因此在windows平台效果极佳，但没有macOS版本。
    - TeamViewer。知名远程控制、会议软件。局域网下免费流畅较为清晰，唯一缺点需要手动禁止每台下位机控制上位机的权限。几十台下位机每天点一遍不可行。
    - VNC。macOS自带服务，易于开启，缺点过于清晰、高上传带宽10MB/s每台下位机，几十台下位机后上传带宽达到局域网设备极限70MB/s，高延迟8s。
      又尝试了单独的vnc软件，调低画质，但缺点一是同TeamViewer下位机掌握是否可以控制上位机的权限，一旦有一台下位机没设置好就会导致上位机鼠标🖱️乱窜无法授课，上位机无法设置。
      二是延迟同样高，查了下是免费开源协议的自身缺陷。三是上位机切换工作桌面就会卡死。  
      但vnc协议也有用武之地，在一些医院🏥、高铁站🚄看到的信息提示屏就用的vnc连接。
    - xxx会议软件。vnc、rtmp等开源软件套皮且收费。
    - nginx-rtmp插件。熟悉nginx,网上教程的一种主流做法，但这个插件的git仓库好几年没更新了，不太放心。
    - webRTC。让人耳目一新的浏览器新技术，通过浏览器就可以控制操作系统分享屏幕🖥或录制⏺屏幕很神奇。️p2p连接，跨平台，低延迟不到1s，上位机可以选择是否允许下位机控制自己。
      完美符合需求但缺点：最多支持10个下位机，不能调整画质，相关开发资料极少，软件支持bug chrome76即使开了权限也在macOS10.15.0上也不可用。  
      效果视频不清晰将就看：  
      <video src="./videos/webRTC.mp4" type="video/mp4" autoplay loop muted></video>  
      想尝试的访问[webRTC在线demo地址](https://www.webrtc-experiment.com/screen-sharing/) 。
    - 最终选择了srs。延迟1-2s，勉强能用。
    
    结论：局域网直播的需求太小众也无商业价值没人研究，让公司购买投影仪才是正解✅。没投影仪的情况下再考虑自建srs服务。

## 服务端自建教程
无，因为我只是部署现成开源项目，想自己尝试的可以直接看作者文档。但你可以从本文客户端测试中了解个大概。  
个人建议流程:  
1. ⭐️搞清相关协议名词。否则看不懂各类教程。  
阅读一圈文章后唯有这篇说的清楚  
[理解RTMP、HttpFlv和HLS的正确姿势---简书](https://www.jianshu.com/p/32417d8ee5b6)
2. 作者官方github仓库阅读入门文档，先不要看其它细节文档。  
[github srs](https://github.com/ossrs/srs)  
首先尝试clone方式，开箱即用，clone完项目一行命令就可以启动服务。
作者提供的web页面功能较多，一开始你可能不知道🤷‍怎么做。启动服务后建议根据上面demo流程来推流、拉流。
成功后尝试项目目录下预先提供的不同配置(例如低延迟)，不同流协议，重启服务。
3. docker方式  
本demo使用这种方式，版本3.0。  
[git docker](https://github.com/ossrs/srs-docker#srs3)  
[docker hub](https://hub.docker.com/r/ossrs/srs)
4. 后续玩法
(未尝试)手机端直播、互动，跟成熟产品很像了。
[github SunLiner/MiaowShow](https://github.com/SunLiner/MiaowShow)

商业需求: 
建议直接使用云服务厂商的接口，一条龙服务。直播算法只有大公司和这方面垂直领域的公司才搞的动。自己搞成本太高。  